(this["webpackJsonpcompatify-app"]=this["webpackJsonpcompatify-app"]||[]).push([[0],{201:function(e,t,a){e.exports=a(418)},206:function(e,t,a){},415:function(e,t,a){},418:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a.n(r),c=a(64),o=a.n(c),s=a(420),i=(a(206),a(8)),l=a(9),u=a(11),p=a(10),f=a(12),m=a(422),d=a(174),g=a(421),h=a(65),v=a(3),b=a.n(v),y=a(6),k=a(161),E=a(31),O=a.n(E);var w={init:function(){},log:function(e){console.error(e)}};O.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(w.log(e),h.toast.error("An unexpected error occurrred.")),Promise.reject(e)}));var j={get:O.a.get,post:O.a.post,put:O.a.put,delete:O.a.delete,setJwt:function(e){O.a.defaults.headers.common["x-auth-token"]=e}},_=a(162),x=a.n(_);function S(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function U(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?S(a,!0).forEach((function(t){Object(k.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):S(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N=Object({NODE_ENV:"production",PUBLIC_URL:""}).API_URL?Object({NODE_ENV:"production",PUBLIC_URL:""}).API_URL:"http://localhost:8000/api",D="authUrl",C="spotifyUserId",A="refreshToken",P="shareUrl";function R(){return(R=Object(y.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(N+"/auth");case 2:return t=e.sent,a=t.data.auth_url,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){localStorage.setItem(C,e)}function I(){return localStorage.getItem(A)}function F(){return(F=Object(y.a)(b.a.mark((function e(t){var a,r,n,c,o,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(N+"/get_profile/?user_id=".concat(t));case 2:return a=e.sent,e.next=5,M(t);case 5:return r=e.sent,n=r.data,c=n.user_id,o=n.share_url,s=U({user_id:c,share_url:o},a.data),e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return j.get(N+"/get_spotify_user/?user_id=".concat(e))}function L(){return(L=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(N+"/get_spotify_user_by_pk/?pk=".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return(B=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(N+"/get_shared_profile/?code=".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e){return G.apply(this,arguments)}function G(){return(G=Object(y.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return localStorage.removeItem(C),e.abrupt("return",null);case 3:return a="refresh_token=".concat(t),e.next=6,j.post(N+"/get_current_user/",a);case 6:return T((r=e.sent).data.id),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(y.a)(b.a.mark((function e(){var t,a,r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=I(),e.next=3,W(t);case 3:return a=e.sent,r=a.data,n=j.get(N+"/new_share_url/?user_id=".concat(r.id)),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return(K=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.get(N+"/get_all_reports_for_user/?user_1_id=".concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z={authorizeSpotifyAccountAccess:function(){return R.apply(this,arguments)},createCompatibilityReport:function(e,t){var a={user_id:e,share_url:t};return j.post(N+"/compatify/",x.a.stringify(a))},getCompatibilityReport:function(e){return j.get(N+"/get_report/?pk=".concat(e))},getCurrentSpotifyUser:W,getAllReportsForUser:function(e){return K.apply(this,arguments)},removeRefreshToken:function(){return localStorage.removeItem(A)},getSpotifyUserByPk:function(e){return L.apply(this,arguments)},saveSpotifyUserId:T,getSpotifyUserId:function(){return localStorage.getItem(C)},saveRefreshToken:function(e){localStorage.setItem(A,e)},getSharedProfile:function(e){return B.apply(this,arguments)},getRefreshToken:I,getUserShareUrl:function(e){return j.get(N+"/get_share_url/?user_id=".concat(e))},getNewShareUrl:function(){return V.apply(this,arguments)},removeShareUrl:function(){return localStorage.removeItem(P)},createProfile:function(e,t){return j.get(N+"/generate_profile/?user_id=".concat(e,"&refresh_token=").concat(t))},saveShareUrl:function(e){localStorage.setItem(P,e)},getShareUrl:function(){return localStorage.getItem(P)},getProfile:function(e){return F.apply(this,arguments)},getAuthUrl:function(){return localStorage.getItem(D)},getUserId:function(){return localStorage.getItem(C)},getToken:function(e){return j.get(N+"/auth_get_token/?url=".concat(e))}},J=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={},a.logInWithSpotify=Object(y.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.authorizeSpotifyAccountAccess();case 2:t=e.sent,(r=a.props.compatifyShareUrl)&&z.saveShareUrl(r),window.location=t;case 6:case"end":return e.stop()}}),e)}))),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement("button",{className:"btn btn-secondary",onClick:this.logInWithSpotify},this.props.message||"Log in with Spotify")}}]),t}(r.Component),Q=function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"center loader"},n.a.createElement("i",{className:"fa fa-spinner fa-spin"}),n.a.createElement("p",{className:"loading-ellipse",style:{fontSize:"0.25em"}},e.message)))},Y=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={data:{},loading:!0},a.createProfile=function(){var e=Object(y.a)(b.a.mark((function e(t,r){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.createProfile(t,r);case 2:n=e.sent,a.setState({data:n.data,loading:!1});case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=z.getUserId(),t=z.getRefreshToken();e&&t&&this.createProfile(e,t)}},{key:"render",value:function(){var e=z.getShareUrl(),t=z.getUserId();return this.state.loading?n.a.createElement(Q,{message:"Creating profile for "+t}):e?n.a.createElement(g.a,{to:"compatify/"}):n.a.createElement(g.a,{to:"profile/".concat(t)})}}]),t}(r.Component),$=a(15),q=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={},a.makeDataObject=function(e){return[{trait:"Valence",A:e.avg_track_valence,fullMark:1},{trait:"Instrumentalness",A:e.avg_track_instru,fullMark:1},{trait:"Popularity",A:e.avg_track_popularity,fullMark:1},{trait:"Energy",A:e.avg_track_energy,fullMark:1},{trait:"Range",A:e.range,fullMark:1}]},a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.name,a=e.data,r=this.makeDataObject(a);return n.a.createElement("div",{className:"card text-white bg-dark mb-3"},n.a.createElement("div",{className:"card-body"},n.a.createElement($.f,{outerRadius:120,width:500,height:300,data:r},n.a.createElement($.c,{stroke:"#ffffff"}),n.a.createElement($.b,{dataKey:"trait",stroke:"#ffffff"}),n.a.createElement($.d,{angle:18,domain:[0,1]}),n.a.createElement($.e,{name:t,dataKey:"A",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6}),n.a.createElement($.a,null),n.a.createElement($.g,{wrapperStyle:{color:"black"}}))))}}]),t}(r.Component),H=a(99),X=function(e){var t=e.title,a=e.link,r=e.onClick,c=e.activeTab,o=t===c?"nav-link bg-dark text-light active":"nav-link bg-dark text-light";return n.a.createElement("li",{className:"nav-item"},n.a.createElement("a",{className:o,href:a,onClick:function(){return r(t)}},t))},Z=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={url:a.props.shareUrl,loading:!1},a.newShareUrl=Object(y.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({loading:!0}),e.next=3,z.getNewShareUrl();case 3:t=e.sent,r=t.data,a.setState({url:r.share_url,loading:!1});case 6:case"end":return e.stop()}}),e)}))),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.url,a=e.loading;return n.a.createElement(n.a.Fragment,null,t?n.a.createElement("h3",null,"compatify.io/p",t):n.a.createElement("p",null,"Click the button below to generate a share url."),n.a.createElement("button",{className:"btn btn-primary",onClick:this.newShareUrl,disabled:a},a?"Getting new URL...":"Get a new share URL"))}}]),t}(r.Component),ee=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={activeTab:"Info"},a.handleChangeTab=function(e){a.setState({activeTab:e})},a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.currentUser,a=e.data,r=t.id,c=t.images,o=t.external_urls,s=this.state.activeTab,i="Info",l="Sharing",u="Options";return n.a.createElement("div",{className:"card text-white bg-dark mb-3 text-center"},n.a.createElement("div",{className:"card-header"},n.a.createElement("ul",{className:"nav nav-tabs card-header-tabs"},n.a.createElement(X,{title:i,link:"#",onClick:this.handleChangeTab,activeTab:s}),n.a.createElement(X,{title:l,link:"#",onClick:this.handleChangeTab,activeTab:s}),n.a.createElement(X,{title:u,link:"#",onClick:this.handleChangeTab,activeTab:s}))),n.a.createElement("div",{className:"card-body"},n.a.createElement("h5",{className:"card-title",style:{textTransform:"uppercase"}},r),s===i&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:"card-text"},n.a.createElement("img",{src:c[0]&&c[0].url,alt:"Profile"})),n.a.createElement("a",{href:o.spotify,className:"btn btn-primary"},"View on Spotify")),s===l&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:"card-text"},n.a.createElement(Z,{userId:r,shareUrl:a.share_url}))),s===u&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:"card-text"},n.a.createElement(H.a,{to:"/create-profile"},n.a.createElement("button",{className:"btn btn-primary"},"Update Profile"))))))}}]),t}(r.Component),te=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={data:{},loading:!0},a.getData=Object(y.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.getAllReportsForUser(a.props.userId);case 2:t=e.sent,a.setState({data:t,loading:!1});case 4:case"end":return e.stop()}}),e)}))),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.loading,r=t.reports;return a?n.a.createElement(n.a.Fragment,null,"Getting reports..."):r?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"card text-white bg-dark mb-3"},n.a.createElement("div",{className:"card-body"},n.a.createElement("p",{className:"card-text"}),n.a.createElement("h4",null,"My Compatify Reports"),n.a.createElement("ul",null,r.map((function(e){return n.a.createElement("li",{key:e.creation_date+e.id},n.a.createElement(H.a,{to:"/display-report/".concat(e.id)},"You and ",e.user2_name,", ",e.creation_date))})))))):n.a.createElement(n.a.Fragment,null,"No reports!")}}]),t}(r.Component),ae=a(173),re=a.n(ae),ne=function(e){var t=e.titleText,a=e.children;return n.a.createElement(n.a.Fragment,null,t&&n.a.createElement("h4",null,t),n.a.createElement("div",{className:"card-columns"},a))},ce=function(e){var t=e.titleText,a=e.artists,r={maxWidth:"50%",height:"auto",display:"block",marginLeft:"auto",marginRight:"auto"};return n.a.createElement(ne,{titleText:t},a&&a.map((function(e){return n.a.createElement(n.a.Fragment,{key:re.a.generate()},n.a.createElement("div",{className:"card text-white bg-dark mb-3"},n.a.createElement("img",{src:e.images[0]&&e.images[0].url,className:"card-img-top",alt:"",style:r}),n.a.createElement("div",{className:"card-body"},n.a.createElement("h5",{className:"card-title"},e.name),n.a.createElement("p",{className:"card-text"},n.a.createElement("b",null,"Popularity: "),e.popularity,"/100"),n.a.createElement("p",{className:"card-text"},n.a.createElement("b",null,"Genres: "),e.genres.map((function(e){return n.a.createElement("li",{key:e},e)}))),n.a.createElement("a",{href:e.external_urls.spotify,className:"btn btn-secondary"},"View on Spotify"))))})))},oe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={data:{},currentUser:{},loading:!0,error:""},a.getProfileData=Object(y.a)(b.a.mark((function e(){var t,r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=z.getRefreshToken()){e.next=4;break}return a.props.history.push("/login"),e.abrupt("return",null);case 4:return e.next=6,z.getCurrentSpotifyUser(t);case 6:return r=e.sent,e.prev=7,e.next=10,z.getProfile(r.data.id);case 10:n=e.sent,a.setState({data:n,currentUser:r.data,loading:!1}),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),e.t0.response&&404===e.t0.response.status&&a.setState({loading:!1,error:"Could not find profile!"});case 17:case"end":return e.stop()}}),e,null,[[7,14]])}))),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getProfileData()}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.currentUser,r=e.loading,c=e.error,o=t.user_id,s=t.avg_track_valence,i=t.avg_track_instru,l=t.avg_track_popularity,u=t.avg_track_energy,p=t.range,f=t.artists,m={avg_track_valence:s,avg_track_instru:i,avg_track_popularity:l,avg_track_energy:u,range:p};return r?n.a.createElement(Q,{message:"Getting profile"}):c?n.a.createElement(n.a.Fragment,null,c):(console.log(Object({NODE_ENV:"production",PUBLIC_URL:""}).API_URL),n.a.createElement(n.a.Fragment,null,n.a.createElement(ee,{currentUser:a,data:t}),n.a.createElement("div",{className:"card-deck"},n.a.createElement(q,{name:o,data:m}),n.a.createElement(te,{userId:o})),n.a.createElement(ce,{artists:f})))}}]),t}(r.Component),se=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={},a.makeDataObject=function(e,t){return[{trait:"Valence",A:e.avg_track_valence,B:t.avg_track_valence,fullMark:1},{trait:"Instrumentalness",A:e.avg_track_instru,B:t.avg_track_instru,fullMark:1},{trait:"Popularity",A:e.avg_track_popularity,B:t.avg_track_popularity,fullMark:1},{trait:"Energy",A:e.avg_track_energy,B:t.avg_track_energy,fullMark:1},{trait:"Range",A:e.range,B:t.range,fullMark:1}]},a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.data1,a=e.data2,r=this.makeDataObject(t,a);return n.a.createElement("div",{class:"card text-white bg-dark mb-3"},n.a.createElement("div",{class:"card-body"},n.a.createElement("p",{class:"card-text"},n.a.createElement($.f,{outerRadius:120,width:500,height:400,data:r},n.a.createElement($.c,{stroke:"#ffffff"}),n.a.createElement($.b,{dataKey:"trait",stroke:"#ffffff"}),n.a.createElement($.d,{angle:18,domain:[0,1]}),n.a.createElement($.e,{name:t.user_id,dataKey:"A",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6}),n.a.createElement($.e,{name:a.user_id,dataKey:"B",stroke:"#800000",fill:"#800000",fillOpacity:.6}),n.a.createElement($.a,null),n.a.createElement($.g,null)))))}}]),t}(r.Component),ie=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).handleChangeTab=function(e){a.setState({activeTab:e})},a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user1Data,a=e.user2Data,r=e.report,c=r.content,o=c.differences,s=c.average_difference,i=o.valence_diff,l=o.instru_diff,u=o.popularity_diff,p=o.energy_diff,f=o.range_diff;return n.a.createElement("div",{className:"card bg-dark mb-3 text-center text-white"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h4",{className:"card-title"},t.user_id," and ",a.user_id),n.a.createElement("h6",{className:"card-title"},"Created on ",r.creation_date),n.a.createElement("p",{className:"card-text"},"Differences: ",i,", ",l,", ",u,",",p,", ",f),n.a.createElement("p",null,"Average Difference: ",s)))}}]),t}(r.Component),le=function(e){var t=e.genres;return n.a.createElement(n.a.Fragment,null,t&&t.map((function(e,t){return n.a.createElement("span",{index:t,class:"badge badge-dark mx-1"},e)})))},ue=function(e){var t=e.tracks,a={maxWidth:"50%",height:"auto",display:"block",marginLeft:"auto",marginRight:"auto"};return n.a.createElement(ne,null,t&&t.map((function(e,t){return n.a.createElement("div",{key:t,className:"card text-white bg-dark mb-3"},n.a.createElement("img",{src:e.album.images[0]&&e.album.images[0].url,className:"card-img-top",alt:"",style:a}),n.a.createElement("div",{className:"card-body"},n.a.createElement("h5",{className:"card-title"},e.name),n.a.createElement("h6",{className:"card-title"},e.artists[0].name),n.a.createElement("p",{className:"card-text"},n.a.createElement("b",null,"Popularity: "),e.popularity,"/100"),n.a.createElement("a",{href:e.external_urls.spotify,className:"btn btn-secondary"},"View on Spotify")))})))},pe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={user1Data:{},user2Data:{},report:{content:{differences:{}}},loading:!0,error:""},a.getData=Object(y.a)(b.a.mark((function e(){var t,r,n,c,o,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.pk,e.next=3,a.getReport(t);case 3:return r=e.sent,e.next=6,a.getUser1Data();case 6:return n=e.sent,e.next=9,z.getSpotifyUserByPk(r.user2);case 9:return c=e.sent,e.next=12,a.getUser2Data(c.user_id);case 12:return o=e.sent,s={user1Data:n,user2Data:o,report:r},e.abrupt("return",s);case 15:case"end":return e.stop()}}),e)}))),a.getUser1Data=Object(y.a)(b.a.mark((function e(){var t,r,n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=z.getRefreshToken()){e.next=4;break}return a.props.history.push("/login"),e.abrupt("return",null);case 4:return e.next=6,z.getCurrentSpotifyUser(t);case 6:return r=e.sent,n=r.data.id,e.next=10,z.getProfile(n);case 10:return c=e.sent,e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)}))),a.getUser2Data=function(){var e=Object(y.a)(b.a.mark((function e(t){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.getUserShareUrl(t);case 2:return a=e.sent,e.next=5,z.getSharedProfile(a.data.share_url);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getReport=function(){var e=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.getCompatibilityReport(t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(b.a.mark((function e(){var t,a,r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getData();case 3:t=e.sent,a=t.user1Data,r=t.user2Data,n=t.report,this.setState({user1Data:a,user2Data:r,report:n,loading:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),this.setState({loading:!1,error:"Couldn't get compatibility report."});case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.user1Data,a=e.user2Data,r=e.report,c=e.loading,o=e.error,s=r.content,i=s.overlapping_genres,l=s.overlapping_artists,u=s.overlapping_tracks;return o?n.a.createElement(n.a.Fragment,null,o):c?n.a.createElement(Q,{message:"Getting Compatify report"}):n.a.createElement(n.a.Fragment,null,n.a.createElement(ie,{user1Data:t,user2Data:a,report:r}),n.a.createElement(se,{data1:t,data2:a}),n.a.createElement("h4",null,"Genres in Common"),n.a.createElement(le,{genres:i}),n.a.createElement("h4",null,"Artists in Common"),n.a.createElement(ce,{artists:l}),n.a.createElement("h4",null,"Tracks in Common"),n.a.createElement(ue,{tracks:u}))}}]),t}(r.Component),fe=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={data:{},loading:!0,error:""},a.getSharedProfileData=Object(y.a)(b.a.mark((function e(){var t,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.shareCode,e.prev=1,e.next=4,z.getSharedProfile(t);case 4:r=e.sent,a.setState({data:r,loading:!1}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),e.t0.response&&404===e.t0.response.status&&a.setState({loading:!1,error:"Invalid code!"});case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getSharedProfileData()}},{key:"render",value:function(){var e=this.state,t=e.data,a=e.loading,r=e.error,c=t.user_id,o=t.share_url,s=z.getSpotifyUserId();return a?n.a.createElement(Q,{message:"Getting profile"}):r?n.a.createElement(n.a.Fragment,null,r):n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,c),c===s&&"This is what others will see when they use your share URL.",n.a.createElement(q,{name:c,data:t}),n.a.createElement("p",null,"Are you musically compatible with ",c,"?"),n.a.createElement(J,{message:"Compatify!",compatifyShareUrl:o}))}}]),t}(r.Component),me=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={user1Data:{},user2Data:{},report:{},loading:!0,error:""},a.getData=Object(y.a)(b.a.mark((function e(){var t,r,n,c,o,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=z.getSpotifyUserId(),r=z.getShareUrl(),e.next=4,a.getUser1Data();case 4:return n=e.sent,e.next=7,a.getUser2Data(r);case 7:return c=e.sent,e.next=10,a.createReport(t,r);case 10:return o=e.sent,s={user1Data:n,user2Data:c,report:o},e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),a.getUser1Data=Object(y.a)(b.a.mark((function e(){var t,r,n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=z.getRefreshToken()){e.next=4;break}return a.props.history.push("/login"),e.abrupt("return",null);case 4:return e.next=6,z.getCurrentSpotifyUser(t);case 6:return r=e.sent,n=r.data.id,e.next=10,z.getProfile(n);case 10:return c=e.sent,e.abrupt("return",c);case 12:case"end":return e.stop()}}),e)}))),a.getUser2Data=function(){var e=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.getSharedProfile(t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.createReport=function(){var e=Object(y.a)(b.a.mark((function e(t,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z.removeShareUrl(),e.next=3,z.createCompatibilityReport(t,a);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(b.a.mark((function e(){var t,a,r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getData();case 3:t=e.sent,a=t.user1Data,r=t.user2Data,n=t.report,this.setState({user1Data:a,user2Data:r,report:n,loading:!1}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),this.setState({loading:!1,error:"Couldn't create compatibility report."});case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.error,r=e.user1Data,c=e.user2Data;return t?n.a.createElement(Q,{message:"Calculating musical compatibility"}):a?n.a.createElement(n.a.Fragment,null,a):(console.log(c),n.a.createElement(g.a,{to:"/display-report/".concat(r.user_id,"/").concat(c.user_id)}))}}]),t}(r.Component),de=function(e){function t(){var e,a;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={data:{},loading:!0,profileExists:!0},a.getProfileData=function(){var e=Object(y.a)(b.a.mark((function e(t){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,z.getProfile(t);case 3:r=e.sent,a.setState({data:r.data,loading:!1}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),e.t0.response&&404===e.t0.response.status&&console.log("This user does not have a profile yet."),a.setState({loading:!1,profileExists:!1});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),a.saveRefreshToken=function(){var e=Object(y.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.getToken(t);case 2:a=e.sent,z.saveRefreshToken(a.data.refresh_token);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(y.a)(b.a.mark((function e(){var t,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location,this.saveRefreshToken(t),a=z.getRefreshToken(),e.next=5,z.getCurrentSpotifyUser(a);case 5:r=e.sent,this.getProfileData(r.data.id);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.loading,a=e.profileExists,r=this.props.match.params.userId,c=z.getShareUrl();return t?n.a.createElement(Q,{message:"Checking whether profile exists for "+r}):c&&a?n.a.createElement(g.a,{to:"/compatify"}):a?n.a.createElement(g.a,{to:"/profile"}):a?n.a.createElement(n.a.Fragment,null):n.a.createElement(g.a,{to:"/create-profile"})}}]),t}(r.Component),ge=function(){return n.a.createElement("h1",null,"Not Found")},he=a(419),ve=function(e){return n.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark"},n.a.createElement(H.a,{className:"navbar-brand",to:"/"},"Compatify"),n.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},n.a.createElement("span",{className:"navbar-toggler-icon"})),n.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarNavAltMarkup"},n.a.createElement("div",{className:"navbar-nav"},n.a.createElement(he.a,{className:"nav-item nav-link",to:"/profile"},"My Profile"))))},be=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){z.removeRefreshToken(),window.location="/"}},{key:"render",value:function(){return null}}]),t}(r.Component),ye=(a(414),a(415),function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(h.ToastContainer,null),n.a.createElement(ve,null),n.a.createElement("main",{className:"container"},n.a.createElement(m.a,null,n.a.createElement(d.a,{path:"/login",component:J}),n.a.createElement(d.a,{path:"/logout",component:be}),n.a.createElement(d.a,{path:"/create-profile",component:Y}),n.a.createElement(d.a,{path:"/logged-in",component:de}),n.a.createElement(d.a,{path:"/compatify",component:me}),n.a.createElement(d.a,{path:"/display-report/:pk",component:pe}),n.a.createElement(d.a,{path:"/not-found",component:ge}),n.a.createElement(d.a,{path:"/profile",component:oe}),n.a.createElement(d.a,{path:"/p:shareCode",component:fe}),n.a.createElement(g.a,{from:"/",exact:!0,to:"/login"}),n.a.createElement(g.a,{to:"/not-found"}))))}}]),t}(r.Component)),ke=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ee(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(416),a(417);o.a.render(n.a.createElement(n.a.Fragment,null,n.a.createElement(s.a,null,n.a.createElement(ye,null))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");ke?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ee(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Ee(e)}))}}()}},[[201,1,2]]]);
//# sourceMappingURL=main.114dbc98.chunk.js.map